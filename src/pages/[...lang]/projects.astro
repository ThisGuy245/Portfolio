---
import Nav from '../../components/Nav.astro';
import Layout from '../../layouts/Layout.astro';
import ProjectCard from '../../components/Card.astro';
import { languages } from '../../i18n/ui';
import { getLangFromUrl, translate, useTranslations } from '../../i18n/utils';

export async function getStaticPaths() {
    return languages.map(lang => ({ params: { lang: lang.key } }));
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const projects = [
    {
        title: 'Unity Game Project',
        body: 'A thrilling action-adventure game developed using Unity. Explore vast worlds and engage in epic battles.',
        href: '#',
        videoSrc: 'https://www.youtube.com/embed/ScMzIvxBSi4',
        placeholderImg: '/path/to/placeholder.jpg', // Fallback image
        category: 'Games'
    },
    {
        title: 'SDL2 Game Demo',
        body: 'A classic 2D platformer built with SDL2. Experience the nostalgia of retro gaming with modern enhancements.',
        href: '#',
        videoSrc: 'https://www.youtube.com/embed/ScMzIvxBSi4',
        placeholderImg: '/path/to/placeholder.jpg',
        category: 'Games'
    },
    {
        title: 'Personal Portfolio Website',
        body: 'A personal website showcasing my work and projects. Built using modern web technologies.',
        href: '#',
        placeholderImg: '/path/to/website-placeholder.jpg',
        category: 'Web'
    },
    {
        title: 'Music Streaming App',
        body: 'An app that allows users to stream and discover new music. Built with a focus on user experience.',
        href: '#',
        placeholderImg: '/path/to/music-placeholder.jpg',
        category: 'Music'
    }
];

function categorizeProjects(projects) {
    const categories = projects.reduce((acc, project) => {
        const { category } = project;
        if (!acc[category]) {
            acc[category] = [];
        }
        acc[category].push(project);
        return acc;
    }, {});
    return categories;
}

const categorizedProjects = categorizeProjects(projects);
---

<Layout title={t('Welcome')}>
    <Nav lang={lang} />
    <main>
        <header>
            <h1>{t('My Portfolio')}</h1>
        </header>
        <section id="about">
            <h2>{t('About Me')}</h2>
            <p>{t('I am a passionate game software engineer with experience in creating immersive gaming experiences. Specializing in game development and design, I enjoy bringing virtual worlds to life.')}</p>
        </section>
        <section id="projects">
            <h2>{t('Projects')}</h2>
            {Object.entries(categorizedProjects).map(([category, projects]) => (
                    <div key={category}>
                        <h3 class="category-header">{category}</h3>
                        <ul class="project-cards">
                            {projects.map(project => (
                                    <ProjectCard project={project} />
                            ))}
                        </ul>
                    </div>
            ))}
        </section>
    </main>
</Layout>

<style>
    .category-header {
        font-size: 1.5rem;
        color: var(--text-color);
        border-bottom: 2px solid var(--accent-color);
        padding-bottom: 0.5rem;
        margin: 1rem 0;
    }

    .project-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        list-style: none;
        padding: 0;
    }

    @media (min-width: 768px) {
        .project-cards {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
    }

    @media (min-width: 1024px) {
        .project-cards {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
    }
</style>
